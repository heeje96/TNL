# 데이터베이스

사람: kim heeje

# 데이터베이스?

**정의**

1. 일정한 규칙 혹은 규약을 통해 구조화되어 저장되는 데이터의 모음
2. (나무위키) 여러 사람에 의해 공유되어 사용될 목적으로 통합하여 관리되는 데이터의 집합을 말한다.

### 데이터베이스 특징

1. 데이터 독립성
2. 데이터 무결성
    1. 잘못된 데이터가 발생하는 경우를 방지하는 기능, 데이터의 유효성 검사를 통과해야 데이터의 무결성을 구현하게 된다.
3. 데이터 보안성
    1. 인가된 사용자만 접근 권한 설정
4. 데이터 일관성
    1. 데이터의 불일치성 배제
5. 데이터 중복 최소화

기타. 실시간 접근, 동시 공유 가능

# DBMS?

- DataBase Management System
- 데이터베이스 자체만으로는 아무것도 못하기 때문에, 그걸 관리하는 시스템(프로그램)과 통합되어 제공되며 이것을 DBMS라고 한다.
- DB는 DBMS를 통해서 응용프로그램과 소통한다.
- ex) MySQL이라는 DBMS가 있고, 이걸 Node.js나 php에서 사용하여 DB와 소통한다.

# RDBMS?

- 행과 열을 가지는 표형식의 데이터를 저장하는 데이터베이스
- 관계형 데이터 베이스의 표준언어

# 용어체크

| 이름 | 설명 | 비슷한 이름 |
| --- | --- | --- |
| 엔터티 | 여러 개 속성을 가진 명사 | 스키마 |
| 릴레이션 | 데이터베이스 정보 구분의 기본 단위 | 테이블, 컬렉션 |
| 속성 | 테이블에서 관리하는 정보(각각의 col) | 필드 |
| 도메인 | 성별이란 속성들이 가질 수 있는 값의 집합 ex{남, 여} |  |
| 필드 | 속성을 가리키는 이름?
속성이 좀 더 근원적임 | 속성, 열 |
| 레코드 | - 속성들을 가진 행 단위의 데이터 | 튜플, 행 |
| 기본키 | Primary Key
유일성과 최소성을 만족시킴 |  |
| 자연키 | 자연스럽게 중복이 없어진 키 |  |
| 인조키 | id, 보통 기본 키로 설정한다. |  |
| 외래키 | Foreign Key, 기본키를 참조하는 값
개체와의 관계 식별을 위해 사용됨 |  |
| 후보키 | 기본키가 될 수 있는 후보들,
유일성과 최소성을 동시에 만족 중 |  |
| 대체키 | 남은 후보키 |  |
| 슈퍼키 | 유일성을 갖춘 키 | UNIQUE |
| 비정형데이터 | 비구조화된, 미리 정의 되지 않은 데이터모델  |  |
| 쿼리 | - 데이터베이스에 정보를 요청하는 것
- 데이터베이스나 파일의 내용중 원하는 것을 검색하기 위해 코드나 키를 기초로 질의하는 것.
- 웹서버에 특정한 정보를 보여달라는 웹클라이언트 요청에 의한 처리
- 명령문
사용자→질의(쿼리문)→DB서버→결과→사용자
 | 질의문, SQL |

### 필드의 타입

- 숫자
    - INT …
- 날짜
    - DATE
    - DATETIME
- 문자
    - CHAR
    - VARCHAR
    - TEXT
    - BLOB : 이미지, 동영상 등 큰데이터 저장에 사용함, 보통은 경로를 VARCHAR로 저장
    - ….

### 관계

- 1:1
- 1:N
    - 외래키로 참조한다.
- N:M
    - 1:N, 1:M이라는 관계를 갖는 테이블 두 개로 나눠서 설정한다.

# ERD?

**정의**

1. 개체관계다이어그램
2. 데이터베이스의 기초(뼈대)역할을 하는, 릴레이션(테이블)간의 관계를 정의한 것
3. 서비스 구축을 위해 시스템의 요구사항을 기반으로 작성된 관계형데이터구조

# 정규화과정?

**정의**

정규화 과정은 

1. **데이터베이스 이상현상을 해결**하거나,
2. **저장공간을 효율적으로 사용**하기 위해

위의 2가지 이유로 릴레이션을 여러개로 분리하는 과정

### 정규화는?

- 중복을 최소화하기 위해 데이터를 구조화하는 작업

### 정규형원칙

같은 의미를 표현하되, 더 좋은 구조, 중복성 감소시키고,

각각의 릴레이션은 독립적인 표현이 가능해야한다.

### 제 1정규형

한개의 기본 키에 대해 두개이상의 값을 가지는 반복집합이 있으면 안된다.

### 제 2정규형

제 1정규형이면서

릴레이션이 부분함수의 종속성을 제거한 상태.

쉽게말해 기본키가 아닌 모든 속성이 기본키에 완전 종속적인 것

### 제 3정규형

제 2정규형이면서

기본키가 아닌 모든 속성이 이행적 함수 종속을 만족하지 않는 상태

**이행적 함수종속?**

A→B와 B→C가 존재하면 논리적으로 A→C가 성립하는데, 이때 집합 C가 이행적으로 함수종속이 되었다고 한다.

### 보이스코드 정규형?

제 3정규형이며, 결정자가 후보키가 아닌 함수 종속 관계를 제거하여 릴레이션의 함수 종속관계에서 **모든 결정자가 후보키**인 상태.

결정자? : X→Y 일때 X가 결정자, Y가 종속자

쉽게말해 후보키가 아닌 것은 릴레이션을 나눈다.

### 장점은?

1. 이상현상 제거
2. 새로운 데이터형을 확장하면 구조를 일부만 변경해된다.
3. 데이터 모델을 의미있게 제공한다.

### 단점은?

릴레이션의 분해로 릴레이션 간의 연산(join)이 많아진다. 이로인해 질의에 대한 응답시간이 느려질 수 있다.

## 단점에서 일어나는 대응책은?

### 반정규화

개발과 운영의 단순화를 위해 중복통합, 분리를 수행하는 데이터 모델링 기법

1. 디스크 I/O량이 많아 조회시 성능 저하
2. 테이블 끼리 경로가 너무 멀 때 join의 횟수가 너무 많을 때
3. 칼럼을 계산하여 조회할 때

**반정규화의 주의사항**

중복이 많아져 데이터의 무결성이 깨질 수 있고, 입력 수정 삭제의 질의문에 대해 응답시간이 늦어질 수 있다.

# 트렌젝션

| 용어 | 설명 | 비슷한용어 |
| --- | --- | --- |
| 커밋 | 여러 쿼리가 성공적으로 처리되었다고 확정하는 명령어. |  |
| 롤백 | 취소하여 일어나기 전으로 돌리는 것. 
커밋과 롤백으로 데이터의 무결성원칙이 보장됨. |  |
| 체크섬 | 중복검사, 오류정정을 통해 무결성을 보호하는 단순한 방법 |  |
| 저널링 | commit 하기 전에 번경사항에 대해 로그를 남기는 것 |  |

### 트랜젝션?

데이터베이스에서 하나의 논리적 기능을 수행하기 위한 작업의 단위

### 특징

a, c, i, d 

1. 원자성
    1. 트랜젝션과 관련된 일이 모두 수행됨(커밋)/안됨(롤백)을 보장하는 것. all and nothing
    2. 트랜젝션이 롤백 되어도 똑같아야한다.
2. 일관성
    1. 허용된 방식으로만 데이터를 변경
3. 격리성
    1. 트랜젝션 수행시 서로 끼어들지 못함(순차실행) 하지만 성능이 나쁠 것이기 때문에 격리수준을 나누어 격리성을 보장한다.
    2. 격리수준
        1. SERIALIZABLE : 가장 엄격
        2. REPEATABLE_REAT : 수정만 엄격
        3. **READ_COMMITTED : 가장 많이 쓰이며, 커밋한 정보만 조회를 허용.** 
            1. 그래서 어떤 다른 트랜잭션이 서로 수정하여 오류가 나오는 경우도 있다.
        4. READ_UNCOMMITTED : 가장 낮은 격리, 방대한 양의 데이터를 어림잡아 집계할 때 쓰임.
    3. 팬텀리드
        1. 같은 쿼리와 같은 트랜젝션시에 다른 결과를 내는 것.
    4. 더티리드
        1. 다른 트랜잭션에 의해 값의 의도된 것과 다르게 나올 때
4. 지속성
    1. 성공적으로 수행된 트랜잭션은 영원히 반영되어야 하고, 장애가 발생해도 원래상태로 복구할 수 있어야한다.

### 무결성

1. 개체무결성 : 기본키는 빈값을 허용하지 않는다.
2. 참조무결성 : 서로 참조 관계에 있는 데이터는 항상 일관된 값을 유지해야 한다.
3. 고유무결성 : UNIQE속성처럼, 고유한 값을 가져야하도록 조건이 주어진 경우
4. NULL 무결성 : NULL이 오면안됨

# 데이터베이스 종류

- 관계형 데이터베이스 SQL언어로 조작한다.
    - MySQL: 가장많이 사용함
    - PostagreSQL: 다음으로 선호하는 데이터베이스기술
- No only SQL
    - mojngoDB: json으로 접근
    - redis: 키-값 모델 데이터베이스

# 질문

### 데이터베이스가 뭐죠

1. 일정한 규칙 혹은 규약을 통해 구조화되어 저장되는 데이터의 모음
2. (나무위키) 여러 사람에 의해 공유되어 사용될 목적으로 통합하여 관리되는 데이터의 집합을 말한다.
3. 1번으로 정의내려지고, 일반적으로 RDBMS를 말하며, RDBMS는 표와같은 데이터의 집합을 관계로 나타낸 것 입니다.

### 정규화의 단점과 그로인한 해결책은?

중복을 제거하기위해 릴레이션을 분해하였기 때문에,
쿼리를 보내면 릴레이션간의 join으로 응답시간이 느려질 수도  있다.
그래서 서비스에 따라 정규화과정과 비정규화, 반정규화 과정을 진행해야 한다.

### 트랜젝션에서 격리성이 왜 중요할까?

여러가지 트랜젝션을 한 번에 처리하는데 있어서 다른 트랜젝션이 침범해버리면, 오류가 발생한다.