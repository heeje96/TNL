# 운영체제 1일차

날짜: 2023년 12월 13일
사람: kim heeje
태그: 운영체제

# 용어

| 드라이버 | 하드웨어를 제어하기 위한 소프트웨어 |
| --- | --- |
| 💩 |  |
|  |  |

# 운영체제

---

### 운영💩체제?

- 정의 : 사용자가 컴퓨터를 쉽게 다루게 해주는 인터페이스이자, 메모리나 자원을 효율적으로 분배해주는 참된 일꾼!
- 정의2: 컴퓨터는 하드웨어와 소프트웨어(유저프로그램)을 관리하는 운영체제와, CPU, 메모리로 나눠져있다.

## 운영체제 역할과 구조

### 역할

1. CPU 스케줄링과 프로세스 관리
    - CPU 소유권을 프로세스에 할당, 프로세스 생성 및 삭제, 자원할당 및 반환
2. 메모리 관리
    - 한정된 메모리를 어떤 프로세스에 얼마큼 할당해하 하는지
3. 디스크파일 관리
4. I/O 디바이스 관리

### 구조

- 소프트웨어(유저 프로그램)
- 운영체제: GUI, 시스템콜, 커널, 드라이버
- 하드웨어

### 시스템 콜이란?

 : 운영체제가 커널에 접근하기 위한 인터페이스이자, 소프트웨어가 운영체제의 서비스를 받기위해 호출할 때 사용

: 프로세스나 스레드에서 운영체제로 요청을 하면, 시스템콜이라는 인터페이스와 커널을 거쳐 운영체제에 전달된다.

### modebit?

: 1 or 0으로 유저모드와 커널모드전환하는 것

- 필요한 이유 :
    - 소프트웨어에서 하드웨어로 바로 접근이 가능하다면, 해킹이 쉽다. 막기 용이하기 위해

## 컴퓨터의 요소

컴퓨터는 CPU, DMA 컨트롤러, 메모리, 타이머, 디바이스 컨트롤러 등으로 이루어져있다.

### CPU

CPU(Central Proccessing Unit)는 산술논리연산장치, 제어장치, 레지스터로 구성되어있는 컴퓨터 장치를 말한다.  인터럽트에 의해 단순히 메모리에 존재하는 명령어를 실행하는 일꾼!

- 커널이 소프트웨어를 메모리에 올려 프로세스로 만들면 CPU가 처리한다.
- 구조
    - 제어장치 ( 조작 지시 )
    - 레지스터 ( 매우빠른 메모리 )
    - 산술논리연산장치 ( 연산 )

### 인터럽트

신호가 들어왔을 때 CPU를 정지시키는 것.

### DMA 컨트롤러

I/O 디바이스가 메모리에 직접 접근할 수 있도록 하는 하드웨어 장치

(보조일꾼)

### 메모리

전자회로에서 데이터, 상태, 명령어를 기록하는 장치이며, 보통 RAM(Random Access Memory)를 메모리라고 한다. CPU는 계산을 담당하고, 메모리는 기억을 담당

# 메모리

---

CPU는 그저 ‘메모리’에 올라와 있는 프로그램의 명령어를 실행할 뿐이다. 메모리계층과 메모리 관리를 알아보자.

## 메모리 계층

메모리 계층은 레지스터, 캐시, 메모리, 저장장치로 구성되어 있다.

- 속도가 빠른 순으로
    - 레지스터 > 캐시 > 주기억장치 > 보조기억 장치

### 캐시

캐시(cache)는 데이터를 미리 복사해 놓는 임시저장소, 빠른 장치와 느린 장치 사이에 병목현상을 줄이기 위한 메모리

### 지역성의 원리

만약 캐시 계층이 없고, 직접 설정해야할 때면?

자주 사용하는 데이터를 기반으로 설정한다.

- 시간 지역성
    - 최근 사용한 데이터에 다시 접근하려는 특성
- 공간 지역성
    - 최근 접근한 데이터 or 그 가까운 공간에 접근한느 특성

### 캐시히트와 캐시미스

- 캐시에서 찾으면 캐시히트, 못찾으면 주 메모리로 내려가서 데이터를 찾는 것을 캐시미스

### 캐시매핑

- 레지스터와 RAM간에 데이터를 주고받을 때 기준으로, 주메모리는 큰데 레지스터는 작기 때문에 매핑을 어떻게 하느냐가 캐시계층 역할을 잘하냐를 정한다.

### ✨💩웹브라우저의 캐시

소프트웨어의 대표적인 캐시로는 웹브라우저의 작은 저장소 쿠키, 로컬 스토리지, 세션 스토리지가 있다. 

- 종류
    
    전부해당: key-value 저장소
    
    - 쿠키~: 서버에서 정하는 만료기한이 있다.
        - (옵션)same site : strict
            - 다른 도메인에서 요청하면 자동 전송된다.
        - (옵션) httponly
            - document.cookie로 쿠키를 볼 수 없게 httponly옵션을 거는 것이 중요하다.
    - 로컬스토리지: 만료기한 X, 10MB 저장 가능하며 웹을 닫아도 유지되고 도메인 단위로 저장, 생성된다. 클라이언트에서 수정가능!
    - 세션스토리지: 만료기한 X, 탭단위로 스토리지 생성, 닫을 때 데이터가 삭제된다. 클라이언트에서 수정가능!

### 데이터베이스의 캐싱 계층

메인 데이터베이스 위에 redis 데이터베이스 계층을 둬서 성능향상 하기도 한다.

## ✨메모리관리

운영체제가 하는 일 중 하나가 메모리 관리이다! 메모리를 극한까지 활용하자!

### 가상메모리

가상메모리는 메모리 관리 기법으로, 추상화하여 큰 메모리로 보이게끔 만든다.

가상 메모리는 가상 주소와 실제 주소가 매핑되어 있고, 프로세스 주소 정보가 들어 있는 ‘페이지 테이블’로 관리된다.

### 스와핑

데이터가 가상 메모리에는 존재하는데, RAM에는 없을때 페이지 폴트가 발생하고 이를 방지하기 위해 데이터가 하드와 RAM을 옮겨다니는 것을 스와핑이라고 한다.

### 페이지 폴트?

RAM에 원하는 데이터가 없을 때, 페이지 폴트가 발생하고, 운영체제를 멈추고 스와핑을 통해 데이터를 찾는다.

### 스레싱

스레싱은 메모리의 페이지 폴트율이 높은것을 의미한다. 이는 곧 많은 스와핑으로 심각한 성능저하!

- 스레싱의 해결방법
    - 메모리 늘리기
    - 속도빠른 저장장치
    - 운영체제에서 해결보기
        - 작업세트
            - 지역성으로 관리
        - PFF
            - 빈도조절관리

### 메모리 할당

연속할당은 순차적으로 할당하는 방식

불연속할당은 현대 운영체제가 쓰는 방식

### 불연속할당

- 패아장
- 세그먼테이션
- 페이지드 세그멘테이션

### 페이지 교체 알고리즘

- 오프라인 알고리즘
- FIFO(선입선출)
- LRU(Least Recentle Used) : 오래된 페이지 변경
- NUR : LRU에서 발전
- LFU : 적은 참조 교체

## 문제

1. 가상메모리에 대해
    - 다중 프로그래밍을 실현하기 위해서는 많은 프로세스들을 동시에 메모리에 올려두어야 한다. 가상메모리는 **프로세스 전체가 메모리 내에 올라오지 않더라도 실행이 가능하도록 하는 기법**이며, 프로그램이 물리 메모리보다 커도 된다는 주요 장점이 있다.
2. **캐시의 지역성**💩 **원리**
    
    `적중율(Hit rate)`을 극대화 시키기 위해 데이터 `지역성(Locality)의 원리`를 사용한다. 지역성의 전제조건으로 프로그램은 모든 코드나 데이터를 균등하게 Access 하지 않는다는 특성을 기본으로 한다. 즉, `Locality`란 기억 장치 내의 정보를 균일하게 Access 하는 것이 아닌 어느 한 순간에 특정 부분을 집중적으로 참조하는 특성인 것이다.
    
    - 시간 지역성 : 최근에 참조된 주소의 내용은 곧 다음에 다시 참조되는 특성.
    - 공간 지역성 : 대부분의 실제 프로그램이 참조된 주소와 인접한 주소의 내용이 다시 참조되는 특성